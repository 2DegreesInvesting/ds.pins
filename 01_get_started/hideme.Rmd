---
output: github_document
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Sharing pins

User stories:

> As a developer I would like to have a way to share different versions of a
dataset so that you can try new data without braking old analyses.

> As an analyst you would like to have a way to access different versions of an
evolving dataset so you can compare them.

We can do this with a pins board in a local folder shared via Dropbox.

### Setup

```{r}
library(tidyverse, warn.conflicts = FALSE)
library(pins)
```

### Create a pins board in a local folder under ~/Dropbox/

```{r}
board <- board_folder("~/Dropbox/pins")
```

### Write a dataset to a pin board

```{r}
dataset <- head(mtcars)
board %>% 
  pin_write(dataset, "mtcars")
```
## Read a dataset from a pin board

```{r}
board %>% 
  pin_read("mtcars")
```

### Overwrite a dataset in a pin board

```{r}
dataset <- head(mtcars, 5)
board %>% 
  pin_write(dataset, "mtcars")
```
See the [qs](https://CRAN.R-project.org/package=qs) package.

### Write a new version of a dataset to a pin board

Sometimes it's useful to version pins, so that writing to an existing pin does
not replace the existing data, but instead adds a new copy. You can activate
versioning with `versioned = TRUE`, and you can do it both for a single pin or
for all pins in a board board.

* Activate versioning for a single pin in a board.

```{r}
dataset <- head(iris)
board %>% 
  pin_write(dataset, "iris", versioned = TRUE)

dataset <- head(iris, 5)
board %>% 
  pin_write(dataset, "iris")

board %>% 
  pin_versions("iris")
```

* Activate versioning for all pins in a board.

```{r}
board <- board_folder("~/Dropbox/pins", versioned = TRUE)

dataset <- head(mtcars)
board %>% 
  pin_write(dataset, "mtcars")

board %>% 
  pin_versions("mtcars")
```

### Read a specific version of a dataset from a pin board

```{r}
versions <- board %>% 
  pin_versions("mtcars")
versions

board %>%
  pin_read("mtcars", version = versions$version[[1]])

board %>%
  pin_read("mtcars", version = versions$version[[2]])
```

```{r include=FALSE}
# Cleanup
fs::dir_delete("~/Dropbox/pins")
```
